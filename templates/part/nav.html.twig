{% set items = {
  'app_content_volunteer' : {
    'text': 'Guide du bénévole',
    'anonymous': true,
  },
  'app_calendar' : {
    'text': 'Planning bénévoles',
    'anonymous': true,
  },
  'app_user_index' : {
    'text': 'Annuaire',
    'anonymous': false,
    'managerOnly': true,
  },
  'app_user_edit' : {
    'text': 'Mes infos',
    'anonymous': false,
  },
  'app_logout' : {
    'text': 'Déconnexion',
    'anonymous': false,
  }
} %}

{% set hidden_break = app.user ? 'lg:hidden' : 'md:hidden' %}
{% set flex_break = app.user ? 'lg:flex' : 'md:flex' %}

<nav class="bg-purple border-gray-200 text-white">
  <div class="container mx-auto">
    <div class="flex justify-between px-4">
      <div class="logo-text flex space-x-7">
        <a href="{{ path('app_content_home') }}" class="flex items-center px-2 logo">
          <img class="nav-logo mr-3" src="{{ asset('img/menu_logo.png') }}" alt="Frig'o dons">
          <span class="inline-block">Frig'o dons</span>
        </a>
      </div>
      <div class="hidden {{ flex_break }} items-center">
        {% for pathName, item in items %}
          {% if item.anonymous or app.user %}
            {% if item.managerOnly is not defined or is_granted('ROLE_MANAGER') %}
              <a href="{{ path(pathName) }}"
                 class="menu-link align-middle py-5 h-18 px-4 hover:bg-purple-600 duration-500
              {% if path(pathName) == path(app.request.attributes.get('_route')) %}
                bg-beige text-black hover:bg-beige
              {% endif %}
              ">
                {{ item.text }}
              </a>
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>

      <div class="{{ hidden_break }} flex items-center">
        <button class="outline-none menu-button">
          <svg class="w-6 h-6" x-show="! showMenu" fill="none" stroke-linecap="round"
               stroke-linejoin="round" stroke-width="2" viewBox="0 00 24 24" stroke="currentColor">
            <path d="m4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <div id="mobileMenuBackdrop" class="hidden opacity-40 fixed inset-0 z-40 bg-black"></div>
      <div id="mobileMenu" class="hidden h-screen absolute top-0 right-0 z-50 bg-purple shadow-xl">
        {% for pathName, item in items %}
          {% if item.anonymous or app.user %}
            {% if item.managerOnly is not defined or is_granted('ROLE_MANAGER') %}
              <a href="{{ path(pathName) }}"
                 class="block py-5 h-18 px-4 hover:bg-purple-600 duration-500
              {% if path(pathName) == path(app.request.attributes.get('_route')) %}
                bg-beige text-black hover:bg-beige
              {% endif %}
              ">
                {{ item.text }}
              </a>
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</nav>
<script>
    const btn = document.querySelector('button.menu-button');
    const menu = document.getElementById('mobileMenu');
    const backdrop = document.getElementById('mobileMenuBackdrop');
    btn.addEventListener("click", () => {
        menu.classList.toggle("hidden");
        backdrop.classList.toggle("hidden");
    })
    backdrop.addEventListener("click", () => {
        menu.classList.toggle("hidden");
        backdrop.classList.toggle("hidden");
    })
</script>
